{% extends "characters/base.html" %}

{% load i18n %}
{% load uni_form %}
{% load characters_extras %}

{% block head_title %}{% blocktrans %}Character Sheet{% endblocktrans %} - {{sheet.name}}{% endblock %}

{% block body %}
    {{ sheet.name }}<br/>
    {{ sheet.player.username }}<br/>
<table width="" border="0" bgcolor="white">
<tbody>
<tr>
<td colspan="3" width="675">
<center>
<h3><font color="black" size="2">One World By Night</font></h3>
</center>
</td>
</tr>
<tr><td><a href="{% url sheet_vampire_edit_attributes sheet.slug %}">Edit Attributes</a></td></tr>
<tr>
<td width="240"><font color="black" size="2"><b>Name:</b>
{{ sheet.name }}</font></td>
<td width="235"><span class="top_info"><b>Player:</b>
{{ sheet.player.username }}</span></td>
<td width="200"><font color="black" size="2"><b>Clan:</b>
{{ sheet.vampiresheet.clan }}</font></td>
</tr>
<tr>
<td width="275" valign="top">
<table>
<tbody>
<tr>
<td><font color="black" size="1"><b>Generation:</b>
{{ sheet.vampiresheet.generation }}<br>
<b>Blood:</b> {{ sheet.vampiresheet.blood }}<br>
<b>Will:</b> {{ sheet.vampiresheet.willpower }}<br>
<b>XP:</b> {{ sheet.experience_unspent }}
({{ sheet.experience_earned }})</font></td>
</tr>
</tbody>
</table>
</td>
<td width="200" valign="top">
<table>
<tbody>
<tr>
<td><font color="black" size="1"><b>Nature:</b>
{{ sheet.vampiresheet.nature }}<br>
<b>Demeanor:</b> {{ sheet.vampiresheet.demeanor }}<br>
<b>Title:</b> {{ sheet.vampiresheet.title }}</font></td>
</tr>
</tbody>
</table>
</td>
<td width="200" valign="top">
<table>
<tbody>
<tr>
<td><font color="black" size="1"><b>{{ sheet.vampiresheet.path }}</b>
{{ sheet.vampiresheet.pathtraits }}<br>
<b>Conscience:</b> {{ sheet.vampiresheet.conscience }}<br>
<b>Self-control:</b> {{ sheet.vampiresheet.selfcontrol }}<br>
<b>Courage:</b> {{ sheet.vampiresheet.courage }}</font></td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr>
<td colspan="3" width="675">
<hr></td>
</tr>
<tr>
<td width="275" valign="top">
<table>
<tr><td>
{% trait_category "Physical" %}
</td></tr>
<tr><td>
{% trait_category "Negative Physical" "-" %}
</td></tr>
</table>
</td>
<td width="200" valign="top">
<table>
<tr><td>
{% trait_category "Social" %}
</td></tr>
<tr><td>
{% trait_category "Negative Social" "-" %}
</td></tr>
</table>
</td>
<td width="200" valign="top">
<table>
<tr><td>
{% trait_category "Mental" %}
</td></tr>
<tr><td>
{% trait_category "Negative Mental" "-" %}
</td></tr>
</table>
</td>
</tr>
<tr>
<td width="275" valign="top">
{% trait_category "Abilities" %}
</td>
<td width="200" valign="top">
{% trait_category "Backgrounds" %}
</td>
<td width="200" valign="top">
{% trait_category "Influences" %}
</td>
</tr>
<tr>
<td width="275" valign="top">
{% trait_category "Disciplines" %}
</td>
<td width="200" valign="top">
<table valign="top" align="left">
<tbody>
<tr>
<td>
{% trait_category "Merits" %}
</td>
</tr>
<tr>
<td>
{% trait_category "Flaws" %}
</td>
</tr>
<tr>
<td>
{% trait_category "Derangements" %}
</td>
</tr>
</tbody>
</table>
</td>
<td width="200" valign="top">
{% trait_category "Status" %}
</td>
</tr>
</tbody>
</table>
<div class="traitlist_header">
    <u><b>Experience</b></u>
    <a href="{% url sheet_new_experience_entry sheet.slug %}" rel="facebox"><img src="{{ STATIC_URL }}pinax/images/silk/icons/brick_add.png" /></a>
    <a href="{% url sheet_add_recent_expenditures sheet.slug %}" rel="facebox"><img src="{{ STATIC_URL }}pinax/images/silk/icons/calculator_add.png" /></a>
</div>
<table border="0">
<tr>
    <th></th>
    <th></th>
    <th>+</th>
    <th>Type</th>
    <th>Date</th>
    <th>Reason</th>
    <th>E</th>
    <th>U</th>
</tr>
{% for entry in experience_entries reversed %}
<tr>
    <td><a href="{% url sheet_edit_experience_entry sheet.slug entry.id %}" rel="facebox"><img src="{{ STATIC_URL }}pinax/images/silk/icons/brick_edit.png" /></a></td>
    <td><a href="{% url sheet_delete_experience_entry sheet.slug entry.id %}" rel="facebox"><img src="{{ STATIC_URL }}pinax/images/silk/icons/brick_delete.png" /></a></td>
    <td>{{entry.change}}</td>
    <td>{{entry.get_change_type_display}}</td>
    <td>{{entry.date}}</td>
    <td>{{entry.reason}}</td>
    <td>{{entry.earned}}</td>
    <td>{{entry.unspent}}</td>
</tr>
{% endfor %}
</table>
<p>{{ sheet.note }}</p>
{% endblock %}

{% block extra_body %}
<script type="text/javascript">
    jQuery(document).ready(function($) {
        $(document).bind('reveal.facebox', function() {
            $("form.uniForm").submit(function() {
                form = this;
                jQuery.facebox(function($) {
                    fields = jQuery(form).find("input[type='text']").filter(":enabled");
                    params = {}
                    fields.each(function() {
                        params[this.name] = this.value;
                    });
                    fields = jQuery(form).find("select").filter(":enabled");
                    fields.each(function() {
                        params[this.name] = this.value;
                    });
                    fields = jQuery(form).find("input[type='hidden']");
                    fields.each(function() {
                        params[this.name] = this.value;
                    });
                    jQuery.post(form.getAttribute('action'), params,
                        function(data, textStatus) {
                            jQuery.facebox(data);
                        }
                    );
                });
                return false;
            });
        });
     });
</script>
{% endblock %}
